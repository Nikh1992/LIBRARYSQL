CREATE DATABASE LIBRARY;
USE LIBRARY;

CREATE TABLE BRANCH(
BRANCH_NO INT PRIMARY KEY,
MANAGER_ID INT,
BRANCH_ADDRESS VARCHAR(30),
CONTACT_NO INT);
DESC BRANCH;

CREATE TABLE EMPLOYEE(
EMP_ID INT PRIMARY KEY,
EMP_NAME VARCHAR(20),
POSITION VARCHAR(30),
SALARY INT,
BRANCH_NO INT,
FOREIGN KEY ( BRANCH_NO) REFERENCES BRANCH (BRANCH_NO) );
DESC EMPLOYEE;

CREATE TABLE BOOKS(
ISBN INT PRIMARY KEY,
BOOK_TITLE VARCHAR(50),
CATEGORY VARCHAR(20),
RENTAL_PRICE INT,
STATUS VARCHAR(5),
AUTHOR VARCHAR(20),
PUBLISHER VARCHAR (20) );
DESC BOOKS;

CREATE TABLE CUSTOMER(
CUSTOMER_ID INT PRIMARY KEY,
CUSTOMER_NAME VARCHAR(30),
CUSTOMER_ADDRESS VARCHAR(50),
REG_DATE DATE);
DESC CUSTOMER;

CREATE TABLE ISSUESTATUS(
ISSUE_ID INT PRIMARY KEY,
ISSUED_CUST INT,
ISSUED_BOOK_NAME VARCHAR(30),
ISSUE_DATE DATE,
ISBN_BOOK INT,
FOREIGN KEY( ISSUED_CUST) REFERENCES CUSTOMER( CUSTOMER_ID),
FOREIGN KEY (ISBN_BOOK) REFERENCES BOOKS(ISBN) );
DESC ISSUESTATUS;

CREATE TABLE RETURNSTATUS(
RETURN_ID INT PRIMARY KEY,
RETURN_CUST INT,
RETURN_BOOK_NAME VARCHAR(30),
RETURN_DATE DATE,
ISBN_BOOK2 INT,
FOREIGN KEY (ISBN_BOOK2) REFERENCES BOOKS(ISBN) );
DESC RETURNSTATUS;

INSERT INTO BRANCH VALUES
( 1, 101, 'PATTOM,THIRUVANANTHAPURAM', 955323),
( 2, 102, 'VANCHIYOOR, THIRUVANANTHAPURAM', 988721),
( 3, 103, 'NEMOM, THIRUVANANTHAPURAM', 977654),
( 4, 104, 'KAKKANAD, KOCHI', 966543),
( 5, 105, 'ALUVA, KOCHI', 989001),
( 6, 106, 'KADAPAKKADA, KOLLAM', 977007);
SELECT * FROM BRANCH;

INSERT INTO EMPLOYEE VALUES 
(1, 'VIJAYAKUMAR', 'LIBRARIAN', 35000, 1),
(2, 'NAVEEN KUMAR', 'ASSISTANT', 25000, 1),
(3, 'MARY KURUVILA', 'TECHNICIAN', 30000, 1),
(4, 'NIKHIL MATHEW', 'CLERK', 20000, 1),
(5, 'SHANTHAKUMARI', 'AIDE',15000, 1),
(6, 'CHANDRASEKHER' , 'MANAGER',45000, 1),
(7, 'VALSAMMA', 'CUSTODIAN', 20000, 1),
(8, 'NITHIN ROY', 'IT SUPPORT', 25000,1),
(9, 'XAVIER JOY', 'LIBRARIAN', 30000, 2),
(10, 'MATHEW PRAKAT', 'ASSISTANT', 22000, 2),
(11, 'SHEENA DAVIS', 'MANAGER', 45000,2),
(12, 'PRASHANT', 'LIBRARIAN', 30000, 3),
(13, 'AMAL SHAH', 'MANAGER', 40000,3),
(14, 'DEVASSY', 'LIBRARIAN', 35000, 4),
(15, 'ASLAM KHAN', 'ASSISTANT', 25000, 4),
(16, 'BABU MON', 'TECHNICIAN', 30000, 4),
(17, 'NIRUPAMA MATHEW', 'CLERK', 20000, 4),
(18, 'PRAJWAL BOSE', 'AIDE',15000, 4),
(19, 'LEKHA KURIAN' , 'MANAGER',45000, 4),
(20, 'ROY KUTTAN', 'CUSTODIAN', 20000, 4),
(21, 'DAVID PADIKKAL', 'IT SUPPORT', 25000,4),
(22, 'FATHIMA BEEGUM', 'LIBRARIAN', 30000, 5),
(23, 'RIMA JOSE', 'ASSISTANT', 22000, 5),
(24, 'JISHA NAIR', 'MANAGER', 45000,5),
(25, 'PADMAM J', 'LIBRARIAN', 35000, 6),
(26, 'SANGEETH KUMAR', 'ASSISTANT', 25000, 6),
(27, 'GIREESH KURUVILA', 'TECHNICIAN', 30000, 6),
(28, 'SWAROOP MATHEW', 'CLERK', 20000, 6),
(29, 'MANIKANDAN', 'AIDE',15000, 6),
(30, 'MAHEENDAR MOHAN' , 'MANAGER',45000, 6),
(31, 'SEBA ABDULLAH', 'CUSTODIAN', 20000, 6),
(32, 'RUGMA SANKAR', 'IT SUPPORT', 25000,6);
SELECT * FROM EMPLOYEE;

INSERT INTO BOOKS VALUES 
( 1010, 'PEARLS OF WISDOM', 'NON-FICTION', 15,'YES', 'HARRY MILNER', 'CLARION'),
( 1011, 'QUOTABLE QUOTES', 'NON-FICTION', 15, 'YES', 'AUBREY MALONE', 'CLARION'),
( 1012, 'RICH DAD POOR DAD', 'NON-FICTION', 35, 'NO', 'ROBERT T K', 'PLATA'),
( 1013, 'NAALUKETTU', 'FICTION', 25, 'NO', 'MT VASUDEVAN', 'CURRENT BOOKS'),
( 1014, 'NIGHT TO REMEMBER', 'AUTOBIOGRAPHY',30 ,'NO', 'WALTER LORD', 'PENGUIN BOOKS'),
( 1015, 'A GOOD GIRL', 'FICTION', 10, 'YES', 'CHANDANA ROY', 'BLACK INK'),
( 1016, 'BODY SCIENCE', 'FICTION', 20, 'YES', 'BENYAMIN', 'MATHRBHUMI'),
( 1017, 'GOATLIFE', 'AUTOBIOGRAPHY', 35, 'NO', 'BENYAMIN', 'MATHRBHUMI'),
( 1018, 'BASHEER COLL VOL 1', 'FICTION', 30, 'NO', 'M BASHEER', 'DC BOOKS'),
( 1019, 'BASHEER COLL VOL 2', 'FICTION', 30, 'YES', 'M BASHEER', 'DC BOOKS'),
( 1020, 'TALE OF A PLACE', 'FICTION', 25, 'NO', 'SK POTTAKAD', 'DC BOOKS'),
( 1021, 'TALE OF A STREET', 'FICTION', 25, 'YES', 'SK POTTAKAD', 'DC BOOKS'),
( 1022, 'ONE INDIAN GIRL', 'FICTION', 20, 'YES', 'CHETAN BHAGAT', 'RUPA PUBL'),
( 1023, 'GIRL IN 105', 'FICTION', 20, 'YES', 'CHETAN BHAGAT', 'WESTLAND'),
( 1024, '2 STATES', 'AUTOBIOGRAPHY', 30, 'NO', 'CHETAN BHAGAT', 'RUPA PUBL');
SELECT * FROM BOOKS;

INSERT INTO CUSTOMER VALUES
( 1, 'NIKHIL SANKAR', 'PATTOM,THIRUVANANTHAPURAM', '2020-07-26'),
( 2, 'NIRUPAMA SANKAR', 'PATTOM, THIRUVANANTHAPURAM', '2021-09-14'),
( 3, 'MANINDER MOHAN', 'MANACAD, THIRUVANANTHAPURAM', '2020-07-27'),
( 4, 'PARVATHY KALIDAS', 'KAKKANAD, KOCHI', '2023-03-12'),
( 5, ' JAYARAM SHARMA', 'ALUVA, KOCHI','2022-01-23'),
( 6, 'DEVAN KURUP', 'RANDAMKUTTI,KOLLAM', '2023-04-05'),
( 7, 'AHMAD KUTTY', 'PALAYAM, THIRUVANANTHAPURAM', '2019-02-13'),
( 8, 'KOYA SAHAB', 'MATTANCHERI, KOCHI', '2023-08-12'),
( 9, 'JOSHY VARGHESE', 'FORT KOCHI, KOCHI', '2024-01-23'),
(10, 'JYOTHY VARGHESE', 'KALAMASSERI,KOCHI', '2022-09-15'),
(11, 'HANANSHA HASHIM', 'ULLOOR, THIRUVANANTHAPURAM', '2019-12-12'),
( 12, 'VIJAYAN', 'KOTTARAKARA,KOLLAM', '2023-11-10'),
(13, 'SREELEKHA', 'NEMOM,THIRUVANANTHAPURAM', '2024-02-15'),
(14, 'KURIKOSE', 'ALUVA, KOCHI', '2020-10-10'),
(15, 'ROBY ROY', 'KOWDIAR, THIRUVANANTHAPURAM', '2021-01-01'),
(16, 'TOM MATHEW', 'KULAKADA,KOLLAM', '2021-05-08'),
(17, 'RAASHI JAIKUMAR','ANGAMALI,KOCHI','2021-08-05'),
(18, 'JATIN RAMDAS', 'KOWDIAR, THIRUVANANTHAPURAM', '2020-09-06'),
(19, 'APPU SHARAN', 'KAKKANAD,KOCHI', '2019-12-30'),
(20, 'HASHIM ALI', 'ALUVA, KOCHI', '2021-02-02');
SELECT * FROM CUSTOMER;

INSERT INTO ISSUESTATUS VALUES
( 1, 1, 'GOATLIFE', '2021-09-13', 1017),
( 2, 1, 'TALE OF A PLACE', '2021-10-10',1020),
( 3, 1, 'NIGHT TO REMEMBER', '2022-05-08', 1014),
( 4, 1, 'PEARLS OF WISDOM', '2022-11-11',1010),
( 5, 1, 'BASHEER COLL VOL 1', '2023-08-01', 1018),
( 6, 2, 'BODY SCIENCE', '2021-09-30', 1016),
( 7, 2, 'NIGHT TO REMEMBER', '2022-01-02', 1014),
( 8, 2, 'ONE INDIAN GIRL', '2022-05-09', 1022),
( 9, 2, '2 STATES', '2022-08-12', 1024),
(10,2,  'GIRL IN 105', '2022-11-23', 1023),
(11, 4, 'GOATLIFE', '2023-05-30', 1017),
(12, 4, 'QUOTABLE QUOTES', '2023-09-19', 1011),
(13, 5, 'TALE OF A STREET', '2022-02-20', 1021),
(14, 5, 'TALE OF A PLACE', '2022-05-29', 1020),
(15, 6, 'RICH DAD POOR DAD', '2023-06-06', 1012),
(16, 8, 'BASHEER COLL VOL 1', '2023-10-20', 1018),
(17, 8, 'BASHEER COLL VOL 2', '2024-01-21', 1019),
(18, 9, 'NAALUKETTU', '2024-02-02', 1013),
(19, 10, 'PEARLS OF WISDOM','2022-09-16', 1010),
(20, 10, 'A GOOD GIRL', '2023-04-03', 1015),
(21, 12, 'NAALUKETTU', '2023-11-10', 1013),
( 22, 12, 'NIGHT TO REMEMBER', '2023-12-31', 1014),
( 23, 13, 'NAALUKETTU', '2024-04-01', 1013),
(24, 13, 'GOATLIFE', '2024-05-03', 1017),
(25, 14, '2 STATES', '2021-06-09', 1024),
( 26, 16, 'BODY SCIENCE', '2022-12-01', 1016),
( 27, 17, 'GIRL IN 105', '2021-12-13', 1023),
(28, 18, 'RICH DAD POOR DAD', '2021-01-12', 1012),
(29, 20, 'RICH DAD POOR DAD', '2021-04-15', 1012),
(30, 20, 'PEARLS OF WISDOM', '2021-10-16', 1010);
SELECT * FROM ISSUESTATUS;

INSERT INTO RETURNSTATUS VALUES
( 1, 1, 'GOATLIFE', '2021-10-13', 1017),
( 2, 1, 'TALE OF A PLACE', '2021-11-10',1020),
( 3, 1, 'NIGHT TO REMEMBER', '2022-06-08', 1014),
( 4, 1, 'PEARLS OF WISDOM', '2022-12-11',1010),
( 5, 1, 'BASHEER COLL VOL 1', '2023-09-01', 1018),
( 6, 2, 'BODY SCIENCE', '2021-11-30', 1016),
( 7, 2, 'NIGHT TO REMEMBER', '2022-03-02', 1014),
( 8, 2, 'ONE INDIAN GIRL', '2022-06-09', 1022),
( 9, 2, '2 STATES', '2022-10-12', 1024),
(10,2,  'GIRL IN 105', '2022-12-23', 1023),
(11, 4, 'GOATLIFE', '2023-07-30', 1017),
(12, 4, 'QUOTABLE QUOTES', '2023-11-19', 1011),
(13, 5, 'TALE OF A STREET', '2022-03-20', 1021),
(14, 5, 'TALE OF A PLACE', '2022-06-29', 1020),
(15, 6, 'RICH DAD POOR DAD', '2023-08-06', 1012),
(16, 8, 'BASHEER COLL VOL 1', '2023-12-20', 1018),
(17, 8, 'BASHEER COLL VOL 2', '2024-02-21', 1019),
(18, 9, 'NAALUKETTU', '2024-03-02', 1013),
(19, 10, 'PEARLS OF WISDOM','2022-10-16', 1010),
(20, 10, 'A GOOD GIRL', '2023-07-03', 1015),
(21, 12, 'NAALUKETTU', '2023-12-10', 1013),
( 22, 12, 'NIGHT TO REMEMBER', '2024-01-31', 1014),
( 23, 13, 'NAALUKETTU', '2024-05-01', 1013),
(24, 13, 'GOATLIFE', '2024-06-03', 1017),
(25, 14, '2 STATES', '2021-07-09', 1024),
( 26, 16, 'BODY SCIENCE', '2023-01-01', 1016),
( 27, 17, 'GIRL IN 105', '2022-01-13', 1023),
(28, 18, 'RICH DAD POOR DAD', '2021-03-12', 1012),
(29, 20, 'RICH DAD POOR DAD', '2021-05-15', 1012),
(30, 20, 'PEARLS OF WISDOM', '2021-11-16', 1010);
SELECT * FROM RETURNSTATUS;

SELECT BOOK_TITLE, CATEGORY, RENTAL_PRICE FROM BOOKS WHERE STATUS = 'YES';

SELECT EMP_NAME, SALARY FROM EMPLOYEE ORDER BY SALARY DESC;

SELECT ISSUESTATUS.ISSUED_BOOK_NAME AS BOOK_TITLE, CUSTOMER.CUSTOMER_NAME FROM ISSUESTATUS INNER JOIN CUSTOMER ON ISSUESTATUS.ISSUED_CUST = CUSTOMER.CUSTOMER_ID;

SELECT CATEGORY, COUNT(*) AS NUMBER_OF_BOOKS FROM BOOKS GROUP BY CATEGORY;

SELECT EMP_NAME, POSITION FROM EMPLOYEE WHERE SALARY > 30000;

SELECT CUSTOMER.CUSTOMER_NAME FROM CUSTOMER LEFT JOIN ISSUESTATUS ON CUSTOMER.CUSTOMER_ID = ISSUESTATUS.ISSUED_CUST WHERE CUSTOMER.REG_DATE < '2022-01-01' AND ISSUESTATUS.ISSUED_CUST IS NULL;

SELECT BRANCH_NO, COUNT(*) AS TOTAL_EMPLOYEES FROM EMPLOYEE GROUP BY BRANCH_NO;

SELECT CUSTOMER.CUSTOMER_NAME FROM CUSTOMER INNER JOIN ISSUESTATUS ON CUSTOMER.CUSTOMER_ID = ISSUESTATUS.ISSUED_CUST WHERE MONTH(ISSUESTATUS.ISSUE_DATE) = 6 AND YEAR(ISSUESTATUS.ISSUE_DATE) = 2023;

SELECT BOOK_TITLE FROM BOOKS WHERE BOOK_TITLE LIKE 'TALE%';

SELECT BRANCH_NO, COUNT(*) AS NUMBER_OF_EMPLOYEES FROM EMPLOYEE GROUP BY BRANCH_NO HAVING COUNT(*)>5;

SELECT EMPLOYEE.EMP_NAME AS BRANCHMANAGER, BRANCH.BRANCH_ADDRESS FROM EMPLOYEE INNER JOIN BRANCH ON EMPLOYEE.BRANCH_NO = BRANCH.BRANCH_NO WHERE EMPLOYEE.POSITION = 'MANAGER';

SELECT DISTINCT CUSTOMER.CUSTOMER_NAME FROM ISSUESTATUS INNER JOIN CUSTOMER ON ISSUESTATUS.ISSUED_CUST = CUSTOMER.CUSTOMER_ID INNER JOIN BOOKS ON ISSUESTATUS.ISBN_BOOK = BOOKS.ISBN WHERE BOOKS.RENTAL_PRICE > 25;